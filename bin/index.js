var f=document.getElementById("canvas"),h=f.getContext("2d"),k=!1,l=!1,m=0,n=0,p=document.getElementById("ScaleValue"),q=document.getElementById("WidthValue"),t=document.getElementById("HeightValue"),u=document.getElementById("ProbabilityValue"),v=document.getElementById("StepsValue");f.width=1600;f.height=800;function w(){this.a=[[]];var b=[];this.b=80;this.c=40;for(var a=0;80>a;a++){for(var e=0;40>e;e++)b.push(!1);this.a.push(b);b=[]}}
w.prototype.show=function(b){b.strokeStyle="grey";for(var a=0;a<this.b;a++)for(var e=0;e<this.c;e++)b.fillStyle="white",this.a[a][e]&&(b.fillStyle="black"),b.fillRect(20*a,20*e,20,20),b.strokeRect(20*a,20*e,20,20)};
w.prototype.update=function(){for(var b=[],a,e=[],c=0;c<this.b;c++){for(var d=0;d<this.c;d++){a=0;0!==c&&(this.a[c-1][d]&&(a+=1),d!==this.c-1&&this.a[c-1][d+1]&&(a+=1));0!==d&&(this.a[c][d-1]&&(a+=1),0!==c&&this.a[c-1][d-1]&&(a+=1),c!==this.b-1&&this.a[c+1][d-1]&&(a+=1));c!==this.b-1&&this.a[c+1][d]&&(a+=1);d!==this.c-1&&(this.a[c][d+1]&&(a+=1),c!==this.b-1&&this.a[c+1][d+1]&&(a+=1));var g=a;this.a[c][d]?(a=!0,2===g&&(a=!0),3===g&&(a=!0),3<g&&(a=!1),2>g&&(a=!1)):(a=!1,3===g&&(a=!0));e.push(a)}b.push(e);
e=[]}this.a=b};var x=new w;f.addEventListener("mousedown",function(b){l=!0;var a=Math.floor(b.layerX/20);b=Math.floor(b.layerY/20);x.a[a][b]=x.a[a][b]?!1:!0});addEventListener("mouseup",function(){l=!1});f.addEventListener("mousemove",function(b){var a=Math.floor(b.layerX/20);b=Math.floor(b.layerY/20);if(a!==m||b!==n)l&&(x.a[a][b]=x.a[a][b]?!1:!0),m=a,n=b});
addEventListener("keypress",function(b){if(" "===b.key||"p"===b.key)k=k?!1:!0;if("r"===b.key){x.a=[];for(var a,e=[],c=x.c,d=x.b,g=0;g<d;g++){for(var r=0;r<c;r++)a=!1,.8<=Math.random()&&(a=!0),e.push(a);x.a.push(e);e=[]}}if("c"===b.key)for(x.a=[[]],a=[],e=x.b,c=x.c,d=0;d<e;d++){for(g=0;g<c;g++)a.push(!1);x.a.push(a);a=[]}"o"===b.key&&(f.style.display="none",document.getElementById("options").style.display="block",k=!1,p.value=(20).toString(),q.value=(80).toString(),t.value=(40).toString(),u.value=
(.8).toString(),v.value=(1).toString())});var y=0;function z(){x.show(h);requestAnimationFrame(z);y+=1;1<=y&&(y=0,k&&x.update())}z();
